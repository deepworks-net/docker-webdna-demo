[Function name=J_CheckLogDirs&scope=GLOBAL]
	[OCB_fCheck path=^/Jarvis/logs]
	[Hideif [OCB_fExists path=^/Jarvis/logs/SQLError.hdr]=T]
		[WRITEFILE ^/Jarvis/logs/SQLError.hdr]SKU	ERROR	APPID	THEDATE	TEMPLATE	PAGE[/WRITEFILE]
	[/Hideif]
	[Hideif [OCB_fExists path=^/Jarvis/logs/SQLError.db]=T]
		[WRITEFILE ^/Jarvis/logs/SQLError.db][!]
		[/!][/WRITEFILE]
	[/Hideif]
[/Function]

[Function name=J_LogSQLError&scope=GLOBAL]
	[J_CheckLogDirs]
	[APPEND db=^/Jarvis/logs/SQLError.db&AUTONUMBER=SKU]error=[URL][err][/URL]&appID=[appID]&thedate=[date] [time][Hideif [isNull varName=file]=T]&template=[file][/Hideif]&page=[URL][thisurlplusget][/URL][/APPEND]
[/Function]

[!] Basic Function To Catch SQL Errors No Matter What! [/!]
[Function name=J_SQLCatch&scope=GLOBAL]
	[Showif [isNull varName=DSN]=T][text]DSN=[dbcatalog][/text][/Showif]
	[Showif [isNull varName=username]=T][text]username=[dbuservar][/text][/Showif]
	[Showif [isNull varName=password]=T][text]password=[dbpassvar][/text][/Showif]
	[text]res=F[/text]
	[IF ("[text show=t]v=[GetChars start=1&trim=both]
		[SQL DSN=[URL][DSN][/URL]&username=[URL][username][/URL]&password=[URL][password][/URL]&statement=[statement];]
			[Hideif [isNull varName=guts]=T][INTERPRET][[guts]][/INTERPRET][/Hideif]
		[/SQL][/GetChars][/text]"="")]
		[THEN][text]res=T[/text][/THEN]
		[ELSE][J_LogSQLError err=[URL][v][/URL]][/ELSE]
	[/IF]
	[RETURN][res][/RETURN]
[/Function]